
import std.*;

public proc void foo(barrier b, chan<int>.read r, timer t) {
    b.sync();
    int d = r.read();
    long time = t.read();
    println("read: " + d + ", time: " + time);
}

public proc void bar(barrier b, chan<int>.write w) {
    b.sync();
    w.write(5);
}

public proc void main(string args[]) {
    timer t;
    barrier b;
    chan<int> c;
    par enroll (b) {
        foo(b, c.read, t);
        bar(b, c.write);
    }
}